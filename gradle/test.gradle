def jacocoReportPath = "$buildDir/jacoco"
test {
    useJUnitPlatform()

    testClassesDirs = sourceSets.test.output.classesDirs
    classpath = sourceSets.test.runtimeClasspath

    testLogging {
        events "PASSED", "FAILED", "SKIPPED"
        exceptionFormat "full"
    }

    jacoco {
        destinationFile = file("${jacocoReportPath}/unitTest.exec")
    }
}

task integrationTest(type: Test) {
    useJUnitPlatform()

    testClassesDirs = sourceSets.test.output.classesDirs
    classpath = sourceSets.test.runtimeClasspath

    testLogging {
        events "PASSED", "FAILED", "SKIPPED"
        exceptionFormat "full"
    }

    jacoco {
        destinationFile = file("${jacocoReportPath}/integrationTest.exec")
    }
}

tasks.withType(Test) {
    finalizedBy tasks.jacocoTestReport
}

jacoco {
    toolVersion = "0.8.7"
}

jacocoTestReport {
    reports {
        xml.required = true
        csv.required = false

        html.outputLocation = layout.buildDirectory.dir("jacocoHtml")
    }
}